<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Curricular – Doctor en Medicina</title>

<style>
body {
    font-family: "Segoe UI", sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 20px;
}

h1 {
    text-align: center;
    margin-bottom: 30px;
    color: #2f4f6f;
}

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
}

.column {
    background: white;
    border-radius: 12px;
    padding: 15px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.column h2 {
    text-align: center;
    color: #4a6fa5;
    margin-bottom: 10px;
}

.column h3 {
    font-size: 14px;
    margin: 10px 0 6px;
    color: #666;
}

.uc {
    background: #e9eef5;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: 0.2s;
    position: relative;
}

.uc:hover {
    background: #dde6f2;
}

.uc.approved {
    background: #cfe8d9;
    color: #2f6f4f;
    text-decoration: line-through;
}

.uc.locked {
    background: #f1f1f1;
    color: #999;
    cursor: not-allowed;
}

.uc.locked:hover::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 110%;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: white;
    padding: 6px 8px;
    border-radius: 6px;
    font-size: 12px;
    white-space: pre-line;
    z-index: 10;
}
</style>
</head>

<body>

<h1>Malla Curricular – Doctor en Medicina (FMED Udelar)</h1>

<div id="grid" class="grid"></div>

<script>
/* ================== DATOS ================== */

const materias = [
    { id:"UC1", nombre:"UC 1 Introducción a la Biología Celular y Molecular", previas:[] },
    { id:"UC2", nombre:"UC 2 Introducción a la Bioestadística", previas:[] },
    { id:"UC3", nombre:"UC 3 Salud Pública y Humanidades e Introducción a la Bioética", previas:[] },
    { id:"UC4", nombre:"UC 4 Aprendizaje en Territorio 1", previas:[] },

    { id:"UC5", nombre:"UC 5 Biología Celular y Molecular", previas:["UC1"] },
    { id:"UC6", nombre:"UC 6 Aprendizaje en Territorio 2", previas:["UC4"] },

    { id:"UC7", nombre:"UC 7 Anatomía Clínica y Bioética", previas:["UC3"] },
    { id:"UC8", nombre:"UC 8 Histología General - Biofísica del Músculo y la Locomoción", previas:["UC5"] },

    { id:"UC9", nombre:"UC 9 Histología de Neuro, Cardio y Respiratorio", previas:["UC5"] },
    { id:"UC10", nombre:"UC 10 Neurociencias", previas:["UC5"] },
    { id:"UC11", nombre:"UC 11 Cardiovascular y Respiratorio", previas:["UC5"] },

    { id:"UC12", nombre:"UC 12 Digestivo, Renal, Endocrino, Metabólico, Reproductor y Desarrollo", previas:["UC5","UC7"] },

    { id:"UC13", nombre:"UC 13 Hematología - Inmunología", previas:["UC5"] },
    { id:"UC14", nombre:"UC 14 Metodología Científica 1", previas:["UC2","UC5|UC13"] },

    { id:"UC15", nombre:"UC 15 Medicina en el Primer Nivel de Atención", previas:["TRIENIO"] },
    { id:"UC16", nombre:"UC 16 Bases Científicas de la Patología", previas:["TRIENIO"] },
    { id:"UC17", nombre:"UC 17 Pediatría", previas:["TRIENIO"] },

    { id:"UC19", nombre:"UC 19 Clínica Médica", previas:["UC15","UC16"] },
    { id:"UC20", nombre:"UC 20 Patología Médica y Terapéutica", previas:["UC16"] },

    { id:"UC18", nombre:"UC 18 Ginecología y Neonatología", previas:["UC15","UC16"] },
    { id:"UC21", nombre:"UC 21 Clínica Quirúrgica", previas:["UC15","UC16"] },
    { id:"UC22", nombre:"UC 22 Patología Quirúrgica", previas:["UC16"] },
    { id:"UC23", nombre:"UC 23 Medicina Familiar y Comunitaria", previas:["UC15"] },

    { id:"UC24", nombre:"UC 24 Metodología Científica 2", previas:["UC15","UC16","UC17|UC18|UC19|UC20|UC21|UC22|UC23"] },

    { id:"UC25", nombre:"UC 25 Internado Rotatorio", previas:["ALL"] }
];

const estructura = {
    "Primer Año": {
        "Primer Semestre":["UC1","UC2","UC3","UC4"],
        "Segundo Semestre":["UC5","UC6"]
    },
    "Segundo Año": {
        "Tercer Semestre":["UC7","UC8"],
        "Cuarto Semestre":["UC9","UC10","UC11"]
    },
    "Tercer Año": {
        "Quinto Semestre":["UC12"],
        "Sexto Semestre":["UC13","UC14"]
    },
    "Cuarto Año": {
        "Séptimo y Octavo Semestre":["UC15","UC16","UC17"]
    },
    "Quinto Año": {
        "Noveno y Décimo Semestre":["UC19","UC20"]
    },
    "Sexto Año": {
        "Onceavo y Doceavo Semestre":["UC18","UC21","UC22","UC23","UC24"]
    },
    "Séptimo Año": {
        "Internado":["UC25"]
    }
};

/* ================== LÓGICA ================== */

let estado = JSON.parse(localStorage.getItem("estadoUC")) || {};

function checkPrevias(previas) {
    if (previas.length === 0) return true;

    if (previas.includes("ALL")) {
        return materias.every(m => estado[m.id]);
    }

    if (previas.includes("TRIENIO")) {
        return ["UC1","UC2","UC3","UC4","UC5","UC6","UC7","UC8","UC9","UC10","UC11","UC12","UC13","UC14"]
            .every(id => estado[id]);
    }

    return previas.every(p => {
        if (p.includes("|")) {
            return p.split("|").some(opt => estado[opt]);
        }
        return estado[p];
    });
}

function render() {
    const grid = document.getElementById("grid");
    grid.innerHTML = "";

    for (const año in estructura) {
        const col = document.createElement("div");
        col.className = "column";
        col.innerHTML = `<h2>${año}</h2>`;

        for (const semestre in estructura[año]) {
            col.innerHTML += `<h3>${semestre}</h3>`;

            estructura[año][semestre].forEach(id => {
                const m = materias.find(x => x.id === id);
                const div = document.createElement("div");
                div.className = "uc";
                div.textContent = m.nombre;

                const previasOK = checkPrevias(m.previas);

                if (estado[id]) {
                    div.classList.add("approved");
                } else if (!previasOK) {
                    div.classList.add("locked");
                    div.dataset.tooltip = "Faltan:\n" + m.previas.join(", ");
                }

                div.addEventListener("click", () => {
                    if (!estado[id] && !checkPrevias(m.previas)) return;
                    estado[id] = !estado[id];
                    localStorage.setItem("estadoUC", JSON.stringify(estado));
                    render();
                });

                col.appendChild(div);
            });
        }
        grid.appendChild(col);
    }
}

render();
</script>

</body>
</html>

