<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Malla Medicina – Udelar</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#0f172a;
  color:#e5e7eb;
  padding:20px;
}
h1{text-align:center}
h2{border-bottom:2px solid #38bdf8;margin-top:30px}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:12px;
}
.uc{
  background:#1e293b;
  padding:12px;
  border-radius:10px;
  cursor:pointer;
  transition:.2s;
}
.uc:hover{background:#334155}
.uc.locked{
  opacity:.35;
  cursor:not-allowed;
}
.uc.unlocked{
  border:2px solid #38bdf8;
}
.uc.approved{
  background:#14532d;
  border:2px solid #4ade80;
}
.credits{color:#93c5fd;font-size:14px}
.lock{font-size:13px;color:#cbd5f5}

#total{
  text-align:center;
  font-size:18px;
  margin-bottom:20px;
}
</style>
</head>

<body>

<h1>Malla Medicina – Facultad de Medicina (Udelar)</h1>
<div id="total"></div>

<div id="malla"></div>

<script>
const ucs = [
  // PRIMER AÑO – PRIMER SEMESTRE
  {id:"UC1",nombre:"UC 1 – Introducción a la Biología Celular y Molecular",cred:10,previa:"6º CVH"},
  {id:"UC2",nombre:"UC 2 – Introducción a la Bioestadística",cred:5,previa:"6º CVH"},
  {id:"UC3",nombre:"UC 3 – Salud Pública y Humanidades e Introducción a la Bioética",cred:11,previa:"6º CVH"},
  {id:"UC4",nombre:"UC 4 – Aprendizaje en Territorio 1",cred:14,previa:"6º CVH"},

  // PRIMER AÑO – SEGUNDO SEMESTRE
  {id:"UC5",nombre:"UC 5 – Biología Celular y Molecular",cred:37,req:["UC1"]},
  {id:"UC6",nombre:"UC 6 – Aprendizaje en Territorio 2",cred:8,req:["UC4"]},

  // SEGUNDO AÑO – PRIMER SEMESTRE
  {id:"UC7",nombre:"UC 7 – Anatomía Clínica y Bioética",cred:34,req:["UC3"]},
  {id:"UC8",nombre:"UC 8 – Histología General - Biofísica del Músculo y la Locomoción",cred:11,req:["UC5"]},

  // SEGUNDO AÑO – SEGUNDO SEMESTRE
  {id:"UC9",nombre:"UC 9 – Histología de Neuro, Cardio y Respiratorio",cred:6,req:["UC5"]},
  {id:"UC10",nombre:"UC 10 – Neurociencias",cred:21,req:["UC5"]},
  {id:"UC11",nombre:"UC 11 – Cardiovascular y Respiratorio",cred:18,req:["UC5"]},

  // TERCER AÑO – PRIMER SEMESTRE
  {id:"UC12",nombre:"UC 12 – Digestivo, Renal, Endocrino, Metabólico, Reproductor y Desarrollo",cred:45,req:["UC5","UC7"]},

  // TERCER AÑO – SEGUNDO SEMESTRE
  {id:"UC13",nombre:"UC 13 – Hematología e Inmunología",cred:27,req:["UC5"]},
  {id:"UC14",nombre:"UC 14 – Metodología Científica 1",cred:18,special:["UC2", "UC12"]},

  // CUARTO AÑO
  {id:"UC15",nombre:"UC 15 – Medicina en el Primer Nivel de Atención",cred:0,req:["TRIENIO"]},
  {id:"UC16",nombre:"UC 16 – Bases Científicas de la Patología",cred:0,req:["TRIENIO"]},
  {id:"UC17",nombre:"UC 17 – Pediatría",cred:0,req:["TRIENIO"]},

  // QUINTO AÑO
  {id:"UC19",nombre:"UC 19 – Clínica Médica",cred:87,req:["UC15","UC16"]},
  {id:"UC20",nombre:"UC 20 – Patología Médica y Terapéutica",cred:23,req:["UC16"]},

  // SEXTO AÑO
  {id:"UC18",nombre:"UC 18 – Ginecología y Neonatología",cred:0,req:["UC15","UC16"]},
  {id:"UC21",nombre:"UC 21 – Clínica Quirúrgica",cred:0,req:["UC15","UC16"]},
  {id:"UC22",nombre:"UC 22 – Patología Médica y Terapéutica",cred:0,req:["UC16"]},
  {id:"UC23",nombre:"UC 23 – Medicina Familiar y Comunitaria y Salud Mental",cred:0,req:["UC15"]},
  {id:"UC24",nombre:"UC 24 – Metodología Científica 2",cred:0,req:["UC14"]},

  // INTERNADO
  {id:"UC25",nombre:"Internado Rotatorio",cred:146,req:["TODO"]},

  // OPTATIVAS
  {id:"OPT",nombre:"Optativas y Electivas",cred:60,manual:true}
];

let aprobadas = new Set(JSON.parse(localStorage.getItem("aprobadas"))||[]);

function primerTrienio(){
  return ["UC1","UC2","UC3","UC4","UC5","UC6","UC7","UC8","UC9","UC10","UC11","UC12","UC13"]
    .every(id=>aprobadas.has(id));
}

function alguna5a13(){
  return ["UC5","UC6","UC7","UC8","UC9","UC10","UC11","UC12","UC13"]
    .some(id=>aprobadas.has(id));
}

function todoAprobado(){
  return ucs.filter(u=>!u.manual).every(u=>aprobadas.has(u.id));
}

function desbloqueada(u){
  if(u.special==="met1")
    return aprobadas.has("UC2") && alguna5a13();
  if(u.special==="met2")
    return aprobadas.has("UC15") && aprobadas.has("UC16") &&
           ["UC17","UC18","UC19","UC21","UC23"].some(id=>aprobadas.has(id));
  if(!u.req) return true;
  if(u.req.includes("TRIENIO")) return primerTrienio();
  if(u.req.includes("TODO")) return todoAprobado();
  return u.req.every(r=>aprobadas.has(r));
}

function render(){
  const m=document.getElementById("malla");
  m.innerHTML="";
  let total=0;

  ucs.forEach(u=>{
    const div=document.createElement("div");
    div.className="uc";

    const ok=desbloqueada(u);
    if(!ok && !aprobadas.has(u.id)) div.classList.add("locked");
    if(ok) div.classList.add("unlocked");
    if(aprobadas.has(u.id)){div.classList.add("approved"); total+=u.cred;}

    div.innerHTML=`
      <strong>${u.nombre}</strong><br>
      <span class="credits">${u.cred} créditos</span><br>
      <span class="lock">${u.previa||""}</span>
    `;

    div.onclick=()=>{
      if(!ok && !aprobadas.has(u.id)) return;
      aprobadas.has(u.id)?aprobadas.delete(u.id):aprobadas.add(u.id);
      localStorage.setItem("aprobadas",JSON.stringify([...aprobadas]));
      render();
    };

    m.appendChild(div);
  });

  document.getElementById("total").innerText=
    `Créditos acumulados: ${total} / 741 (+60 optativas)`;
}

render();
</script>

</body>
</html>
